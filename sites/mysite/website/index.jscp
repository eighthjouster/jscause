<html />
<html>
  <head>
    <title>Example site</title>
  </head>
  <body>
    <h1>This is an example site.</h1>
<js

//  Let's call MariaDB.
console.log('Let us call MariaDB.');

const pool = rt.mariaDbPool;

let dbConn;
const appContinue = rt.waitFor();
let htmlOutput = '?';
pool.getConnection()
  .then(
      (conn) => {
        dbConn = conn;
    conn.query("SELECT * from posts")
    //conn.query("INSERT INTO `posts` (`title`, `contents`, `created_at`) VALUES ('Great success', 'Very nice success contents!', now())")
      .then(
          (result) => {
        htmlOutput = 'GREAT SUCCESS!';//__RP
        console.log(result);
//        for (let i=0;i<result.length;i++) {
//          console.log(result[i]);//__RP
//        }
        appContinue();
        // rows: [ {val: 1}, meta: ... ]
      }
      )
      .catch(
          (e) => {
        htmlOutput = 'NO SUCCESS';//__RP
        console.log(e);//__RP
        appContinue();
      }
      );
  }
  )
  .catch(
      (e) => {
    htmlOutput = 'UGH';//__RP
    console.log(e);//__RP
    appContinue();
  }
  );


//
//	const res = await conn.query("INSERT INTO myTable value (?, ?)", [1, "mariadb"]);
//	// res: { affectedRows: 1, insertId: 1, warningStatus: 0 }

rt.runAfter(() => {
	if (dbConn) dbConn.release(); //release to pool
  console.log('Disconnected from the mariadb database.');
/js>
  <h1>Output:</h1>
  <h1><js= htmlOutput /js></h1>
  </body>
</html>
<js
});

/js>
<h1>Hm</h1>